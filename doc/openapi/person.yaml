
#
# OpenAPI Yaml defintion for Person.
#
components:
  schemas:
    # The identifier value.
    id:
      $ref: "./shared.yaml#/components/schemas/id" 
    statValue:
      $ref: "./shared.yaml#/components/schemas/statValue" 
    Text:
      $ref: "./shared.yaml#/components/schemas/Text"
    SkillValueRef:
      type: object
      properties:
        name: 
          schema:
            $ref: "#/components/schemas/id"
        value:
          schema:
            $ref: "#/components/schemas/statValue"
    NewPerson:
      type: object
      properties:
        name:
          type: string
          description: The name of the character.
        description:
          schema:
            $ref: "#/components/schemas/Text"
        skills:
          type: array
          description: The abilities of the person.
          items:
            # The skill references containing the skill of the person.
            schema:
              $ref: "#/components/schemas/SkillValueRef"      
    Person:
      allOf: 
      - $ref: "#/components/schemas/NewPerson"
      - type: object
        properties:
          id:
            type: string
            summary: The reference identifier of the person.
            description: >
              The XML id compliant unique identifier of the person.
              The identifier ends with "person:" followed by the slugified
              person name.
      required:
      - name
      - id
      - skills
paths:
  # The characters of the game.
  /people:
    get:
      operationId: get-characters
      tags:
        - Characters
        - Identifiers
        - Dune RPG
      summary: Get all characters
      description: Retrieves the current state of the characters.
      responses:
        "200":
          description: Everything wents fine.
          content:
            application/json:
              schema:
                type: array
                minItems: 0
                items:
                  schema:
                    $ref: "#/components/schemas/Person"
  /people/{id}:
    parameters:
      - name: id
        description: The identifier of the character.
        in: path  
        required: true
        schema:
          $ref: "#/components/schemas/id"
    get:
      operationId: get-character
      tags:
        - Characters
        - Dune RPG
        - Get One
      summary: Get one existing character.
      description: Retrieves one character from the current character pool.
      responses:
        "200":
          description: All went fine.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Person"
        "404": 
          description: Not found.
        "501": 
          description: Getting single resource not supported.
        "503":
          description: Getting single resource not possible at the moment.
    delete:
      operationId: remove-character
      tags:
      - Characters
      - Dune RPG
      - Remove
      response:
        "200":
          description: All went fine.
          content:
            application/json: boolean
        "501": 
          description: Removing single resource not supported.
        "503":
          description: Removing single resource not possible at the moment.
    put: 
      operationId: update-character
      tags:
        - Characters
        - Dune RPG
        - Update
      summary: Replace existing character.
      description: Replaces an existing character
      requestBody:
        required: true
        content:
          application/json:
            $ref: "#/components/schemas/NewPerson"
      responses:
        "200":
          description: All went fine.
          content:
            application/json: boolean
        "404": 
          description: Not found.
        "501": 
          description: Setting single resource not supported.
        "503":
          description: Setting single resource not possible at the moment.
    patch: 
      operationId: alter-character
      tags:
        - Characters
        - Dune RPG
        - Alter
      summary: Replace existing character.
      description: Replaces an existing character
      requestBody:
        required: true
        content:
          application/json:
            $ref: "#/components/schemas/NewPerson"
      responses:
        "200":
          description: All went fine.
          content:
            application/json: boolean
        "404": 
          description: Not found.
        "400":
          description: Invalid new property values.
        "501": 
          description: Alter single resource not supported.
        "503":
          description: Alter single resource not possible at the moment.
    post:
      operationId: get-character
      tags:
        - Characters
        - Dune RPG
        - Create New
      summary: Get one existing character.
      description: Retrieves one character from the current character pool.
      requestBody:
        required: true
        content:
          application/json:
            $ref: "#/components/schemas/NewPerson"
      responses:
        "200":
          description: All went fine.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Person"
        "404": 
          description: Not found.
        "501": 
          description: Creating a new resource not supported.
        "503":
          description: Creatign a new resource not possible at the moment.

tags:
  $ref: "./shared.yaml#/tags"
